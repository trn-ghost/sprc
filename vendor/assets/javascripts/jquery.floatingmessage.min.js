/*!
 * Floating Message v1.0.3
 * http://sideroad.secret.jp/
 *
 * Copyright (c) 2009 sideroad
 *
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * Date: 2009-08-18
 * 
 * @author sideroad
 * @require jQuery, jQueryUI
 * 
 */
(function(d){var c={"top-left":10,"top-right":10,"bottom-left":10,"bottom-right":10},e=10,b={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},a=function(k){var n,g=k.attr("id"),u=k.data("floating-message"),h={},j=0,o=u.range,p=u.position,l=u.duration,t=u.stuffEasing,q=u.hide,s=u.close,m=u.timerId,f=u.height+u.margin+(u.padding*2),r=b[u.position];if(m){clearTimeout(m)}for(n=0;n<r.length;n++){u=r[n];if(g==u.id){j=n;continue}if(u.range>o){u.range-=f;h[u.verticalAlign]=u.range;u.elem.stop().animate(h,{duration:l,easing:t,queue:false})}}r.splice(j,1);c[p]-=f;k.stop().hide(q,l,function(){d(this).remove();if(s){s()}})};d.floatingMessage=function(k,h){var m="jqueryFloatingMessage"+new Date().getTime()+""+parseInt(Math.random()*10000,10),j=d('<div id="'+m+'" class="ui-widget-content ui-corner-all ui-floating-message"></div>'),i={},f=0,l=0,g;h=h||{};h=d.extend(true,{position:"top-left",verticalAlign:(h.position||"top-left").split("-")[0],align:(h.position||"top-left").split("-")[1],width:300,height:50,time:false,show:"drop",hide:"drop",padding:10,margin:10,duration:500,stuffEasing:"easeOutBounce",body:d("<div></div>"),open:false,close:false,click:a,elem:j,timerId:false,id:m},h);h.range=c[h.position];f=h.height;l=h.padding;g=h.open;if(k){h.body.html(k.replace(/\n/g,"<br />"))}if(h.className){j.addClass(h.className)}i={width:h.width+"px",height:f+"px",position:"fixed",padding:l+"px"};i[h.verticalAlign]=c[h.position];i[h.align]=e;j.css(i).append(h.body);j.bind("destroy.fms",function(){a(j)});d(document.body).append(j);if(h.click){j.bind("click.fms",function(){h.click(j)})}j.show(h.show,h.duration,function(){if(h.time){h.timerId=setTimeout(function(){h.click(j)},h.time)}if(g){g()}});b[h.position].push(h);c[h.position]+=(f+h.margin+(l*2));j.data("floating-message",h);return h.body};d.fn.floatingMessage=function(f){return this.each(function(){if(typeof f=="string"){d(this).parent(".ui-floating-message").trigger(f+".fms")}else{f=f||{};f.body=this;d.floatingMessage(false,f)}})}})(jQuery);